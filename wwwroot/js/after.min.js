function writeOwnTimesTables(n,t){$("#OwnTimes tbody tr").remove();$.ajax({url:`/OwnTimes?last30days=${n}&selectedUser=${t}`,success:n=>{let t=document.querySelectorAll("#OwnTimes tbody")[0],i=document.querySelectorAll("#OwnTimes tbody")[1];n[0].forEach(n=>{let i=t.insertRow(t.rows.length),r=0;i.insertCell(r).appendChild(document.createTextNode(new Date(n.absentFrom).toLocaleString("de-CH")));i.insertCell(++r).appendChild(document.createTextNode(new Date(n.absentTo).toLocaleString("de-CH")));i.insertCell(++r).appendChild(document.createTextNode(n.reason));let u=$(`<label><input name="isIO" data-id-absence="${n.idAbsence}" type="checkbox" class="filled-in" disabled /><span></span></label>`);n.approved&&(u=$(`<label><input name="isIO" data-id-absence="${n.idAbsence}" type="checkbox" class="filled-in" checked disabled /><span></span></label>`));i.insertCell(++r).appendChild(u[0]);let f=$(`<div><button type="button" class="btn-small" onclick="absenceEdit ('${n.id}')">
<i class="material-icons">edit</i>
</button>
<button type="button" class="btn-small" onclick="absenceDelete('${n.id}')">
<i class="material-icons">delete</i>
</button></div>`);i.insertCell(++r).appendChild(f[0])});n[1].forEach(n=>{let t=i.insertRow(i.rows.length),r=0;t.insertCell(r).appendChild(document.createTextNode(new Date(n.o.date).toLocaleDateString("de-CH")));t.insertCell(++r).appendChild(document.createTextNode(n.o.customer));t.insertCell(++r).appendChild(document.createTextNode(n.o.hours));t.insertCell(++r).appendChild(document.createTextNode(n.od.rate));let u=$(`<div><button type="button" class="btn-small" onclick="overtimeEdit ('${n.id}')">
<i class="material-icons">edit</i>
</button>
<button type="button" class="btn-small" onclick="overtimeDelete('${n.id}')">
<i class="material-icons">delete</i>
</button></div>`);t.insertCell(++r).appendChild(u[0])})}})}function writeControllingTable(n){$("#Controlling tbody tr").remove();$.ajax({url:"/Controlling?uncheckedOnly="+n,success:n=>{let t=document.querySelector("#Controlling tbody");n.forEach(n=>{let i=t.insertRow(t.rows.length),r=0;i.insertCell(r).appendChild(document.createTextNode(n.name));i.insertCell(++r).appendChild(document.createTextNode(new Date(n.absentFrom).toLocaleString("de-CH")));i.insertCell(++r).appendChild(document.createTextNode(new Date(n.absentTo).toLocaleString("de-CH")));i.insertCell(++r).appendChild(document.createTextNode(n.reason));let u=$(`<label><input name="isIO" data-id-absence="${n.idAbsence}" type="checkbox" class="filled-in" /><span></span></label>`);n.approved&&(u=$(`<label><input name="isIO" data-id-absence="${n.idAbsence}" type="checkbox" class="filled-in" checked /><span></span></label>`));i.insertCell(++r).appendChild(u[0])})}})}$("#absenceForm, #overtimeForm, #userForm").on("submit",n=>{n.preventDefault(),$.ajax({url:$(n.target).attr("action"),type:"POST",data:$(n.target).serialize(),success:(n,t,i)=>{i.status===202&&location.reload();let f=$(".red-text"),u=$(n).find(".red-text");for(var r=0;r<u.length;r++)f[r].outerHTML=u[r].outerHTML},error:()=>{alert("Fehler bei der Verarbeitung des Formulars. Überprüfen sie, ob ihre Aktion durchgeführt wurde und versuchen Sie es allenfalls erneut."),location.reload()}})});$("#OwnTimes #filter, #OwnTimes select").change(function(){let n=$("#OwnTimes #filter").prop("checked"),t=$("#OwnTimes select").val();writeOwnTimesTables(n,t)});$("#Controlling #filter").click(()=>{let n=$("#Controlling #filter").prop("checked");writeControllingTable(n)});$("#Controlling #ferienliste").click(()=>{window.open("/Controlling?handler=Ferienliste","_blank")});$("#Controlling #überzeitkontrolle").click(()=>{window.open("/Controlling?handler=Überzeitkontrolle","_blank")});$("#Controlling").on("change",'input[name="isIO"]',n=>{let t=$(n.target).attr("data-id-absence");$.ajax({url:`/Controlling?idAbsence=${t}&value=${n.currentTarget.checked}`,type:"POST",beforeSend:n=>{n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},success:()=>{location.reload()}})});$("#Users #filter").click(()=>{let n=$("#Users #filter").prop("checked");writeUsersTable(n)});